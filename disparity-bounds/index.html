<!DOCTYPE html><html lang="en" data-astro-cid-37fxchfa> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Pragmatic Statistical Toolkit"><title>DisparityBounds | Pragmastat</title><link rel="icon" type="image/svg+xml" href="/img/logo.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" crossorigin="anonymous"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.CDGfc0hd.js"></script><!-- Prevent flash of wrong theme / sidebar state / background color --><script>
      (function() {
        const stored = localStorage.getItem('pragmastat-theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = stored || (prefersDark ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
        // Set background color immediately to prevent flash
        document.documentElement.style.backgroundColor = theme === 'light' ? '#fcfcfc' : '#242936';
        if (stored) {
          document.documentElement.setAttribute('data-theme-setting', stored);
        }
        // Pre-set sidebar collapsed state to prevent layout shift
        if (localStorage.getItem('pragmastat-sidebar-collapsed') === 'true') {
          document.documentElement.setAttribute('data-sidebar-collapsed', '');
        }
      })();
    </script><link rel="stylesheet" href="/_astro/_slug_.Crv_D_PQ.css">
<link rel="stylesheet" href="/_astro/_slug_.BJM9MGeo.css"></head> <body data-astro-cid-37fxchfa>  <div class="layout" id="docs-layout" data-astro-cid-mw7aashj> <aside class="sidebar-container" data-astro-transition-persist="sidebar" data-astro-cid-mw7aashj> <nav class="sidebar" aria-label="Main navigation" data-astro-cid-ssfzsv2f> <div class="sidebar-header" data-astro-cid-ssfzsv2f> <a href="/" class="logo" data-astro-cid-tvrurpns>
Pragmastat
</a>  <div class="sidebar-controls" data-astro-cid-ssfzsv2f> <a href="https://github.com/AndreyAkinshin/pragmastat" class="github-button" target="_blank" rel="noopener noreferrer" aria-label="GitHub repository" data-astro-cid-xtw5atjx> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-astro-cid-xtw5atjx> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" data-astro-cid-xtw5atjx></path> </svg> </a>  <div class="theme-switcher" data-astro-cid-dz5h74bc> <button class="theme-button" id="theme-button" aria-label="Toggle theme" aria-haspopup="true" data-astro-cid-dz5h74bc> <svg class="icon icon-system" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="10" data-astro-cid-dz5h74bc></circle> <path d="M12 2a10 10 0 0 1 0 20" fill="currentColor" stroke="none" data-astro-cid-dz5h74bc></path> </svg> <svg class="icon icon-light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="5" data-astro-cid-dz5h74bc></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-dz5h74bc></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-dz5h74bc></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-dz5h74bc></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-dz5h74bc></line> </svg> <svg class="icon icon-dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-dz5h74bc></path> </svg> </button> <div class="theme-dropdown" id="theme-dropdown" data-astro-cid-dz5h74bc> <button class="theme-option" data-theme="system" data-astro-cid-dz5h74bc> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="10" data-astro-cid-dz5h74bc></circle> <path d="M12 2a10 10 0 0 1 0 20" fill="currentColor" stroke="none" data-astro-cid-dz5h74bc></path> </svg>
System
</button> <button class="theme-option" data-theme="light" data-astro-cid-dz5h74bc> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="5" data-astro-cid-dz5h74bc></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-dz5h74bc></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-dz5h74bc></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-dz5h74bc></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-dz5h74bc></line> </svg>
Light
</button> <button class="theme-option" data-theme="dark" data-astro-cid-dz5h74bc> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-dz5h74bc></path> </svg>
Dark
</button> </div> </div> <script type="module">const n=document.getElementById("theme-button"),o=document.getElementById("theme-dropdown"),s=document.querySelectorAll(".theme-option"),a=document.documentElement;function m(e){return e==="light"||e==="dark"?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function c(e){document.querySelector(".theme-switcher")?.setAttribute("data-setting",e||"system")}function r(e){const t=m(e);a.setAttribute("data-theme",t),e?(a.setAttribute("data-theme-setting",e),localStorage.setItem("pragmastat-theme",e)):(a.removeAttribute("data-theme-setting"),localStorage.removeItem("pragmastat-theme")),c(e)}const d=localStorage.getItem("pragmastat-theme");c(d);n?.addEventListener("click",()=>{o?.classList.toggle("open")});document.addEventListener("click",e=>{!n?.contains(e.target)&&!o?.contains(e.target)&&o?.classList.remove("open")});s.forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-theme");r(t==="system"?null:t),o?.classList.remove("open")})});window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{localStorage.getItem("pragmastat-theme")||r(null)});</script>  <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar" aria-expanded="true" data-astro-cid-lp5naqcd> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-lp5naqcd> <polyline points="11 17 6 12 11 7" data-astro-cid-lp5naqcd></polyline> <polyline points="18 17 13 12 18 7" data-astro-cid-lp5naqcd></polyline> </svg> </button>  </div> </div> <div class="sidebar-section" data-astro-cid-ssfzsv2f> <ul class="sidebar-list" data-astro-cid-ssfzsv2f> <li data-astro-cid-ssfzsv2f> <a href="/synopsis" class="sidebar-link" data-astro-cid-ssfzsv2f> Synopsis </a>  </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> One-Sample Estimators </li><li data-astro-cid-ssfzsv2f> <a href="/center" class="sidebar-link" data-astro-cid-ssfzsv2f> Center </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/center-bounds" class="sidebar-link" data-astro-cid-ssfzsv2f> CenterBounds </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/spread" class="sidebar-link" data-astro-cid-ssfzsv2f> Spread </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/spread-bounds" class="sidebar-link" data-astro-cid-ssfzsv2f> SpreadBounds </a>  </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> Two-Sample Estimators </li><li data-astro-cid-ssfzsv2f> <a href="/shift" class="sidebar-link" data-astro-cid-ssfzsv2f> Shift </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/shift-bounds" class="sidebar-link" data-astro-cid-ssfzsv2f> ShiftBounds </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/ratio" class="sidebar-link" data-astro-cid-ssfzsv2f> Ratio </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/ratio-bounds" class="sidebar-link" data-astro-cid-ssfzsv2f> RatioBounds </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/disparity" class="sidebar-link" data-astro-cid-ssfzsv2f> Disparity </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/disparity-bounds" class="sidebar-link active" aria-current="page" data-astro-cid-ssfzsv2f> DisparityBounds </a> <ul class="sidebar-sublist" data-astro-cid-ssfzsv2f> <li data-astro-cid-ssfzsv2f> <a href="#algorithm" class="sidebar-sublink depth-2" data-astro-cid-ssfzsv2f> Algorithm </a> </li><li data-astro-cid-ssfzsv2f> <a href="#tests" class="sidebar-sublink depth-2" data-astro-cid-ssfzsv2f> Tests </a> </li> </ul> </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> Randomization </li><li data-astro-cid-ssfzsv2f> <a href="/rng" class="sidebar-link" data-astro-cid-ssfzsv2f> Rng </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/uniform-float" class="sidebar-link" data-astro-cid-ssfzsv2f> UniformFloat </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/uniform-int" class="sidebar-link" data-astro-cid-ssfzsv2f> UniformInt </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/sample" class="sidebar-link" data-astro-cid-ssfzsv2f> Sample </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/resample" class="sidebar-link" data-astro-cid-ssfzsv2f> Resample </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/shuffle" class="sidebar-link" data-astro-cid-ssfzsv2f> Shuffle </a>  </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> Distributions </li><li data-astro-cid-ssfzsv2f> <a href="/additive" class="sidebar-link" data-astro-cid-ssfzsv2f> Additive </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/multiplic" class="sidebar-link" data-astro-cid-ssfzsv2f> Multiplic </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/exp" class="sidebar-link" data-astro-cid-ssfzsv2f> Exp </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/power" class="sidebar-link" data-astro-cid-ssfzsv2f> Power </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/uniform" class="sidebar-link" data-astro-cid-ssfzsv2f> Uniform </a>  </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> Implementations </li><li data-astro-cid-ssfzsv2f> <a href="/py" class="sidebar-link" data-astro-cid-ssfzsv2f> Python </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/ts" class="sidebar-link" data-astro-cid-ssfzsv2f> TypeScript </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/r" class="sidebar-link" data-astro-cid-ssfzsv2f> R </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/cs" class="sidebar-link" data-astro-cid-ssfzsv2f> C# </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/kt" class="sidebar-link" data-astro-cid-ssfzsv2f> Kotlin </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/rs" class="sidebar-link" data-astro-cid-ssfzsv2f> Rust </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/go" class="sidebar-link" data-astro-cid-ssfzsv2f> Go </a>  </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> Auxiliary </li><li data-astro-cid-ssfzsv2f> <a href="/avg-spread" class="sidebar-link" data-astro-cid-ssfzsv2f> AvgSpread </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/avg-spread-bounds" class="sidebar-link" data-astro-cid-ssfzsv2f> AvgSpreadBounds </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/median" class="sidebar-link" data-astro-cid-ssfzsv2f> Median </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/sign-margin" class="sidebar-link" data-astro-cid-ssfzsv2f> SignMargin </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/pairwise-margin" class="sidebar-link" data-astro-cid-ssfzsv2f> PairwiseMargin </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/signed-rank-margin" class="sidebar-link" data-astro-cid-ssfzsv2f> SignedRankMargin </a>  </li><li class="sidebar-group-header" data-astro-cid-ssfzsv2f> <svg class="sidebar-group-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-ssfzsv2f> <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" data-astro-cid-ssfzsv2f></path> </svg> Appendix </li><li data-astro-cid-ssfzsv2f> <a href="/assumptions" class="sidebar-link" data-astro-cid-ssfzsv2f> Assumptions </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/foundations" class="sidebar-link" data-astro-cid-ssfzsv2f> Foundations </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/methodology" class="sidebar-link" data-astro-cid-ssfzsv2f> Methodology </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/bibliography" class="sidebar-link" data-astro-cid-ssfzsv2f> Bibliography </a>  </li><li data-astro-cid-ssfzsv2f> <a href="/colophon" class="sidebar-link" data-astro-cid-ssfzsv2f> Colophon </a>  </li> </ul> </div> </nav>  </aside> <main class="main-content" data-astro-cid-mw7aashj> <article class="content" data-astro-cid-mw7aashj> <h1 data-astro-cid-mw7aashj>DisparityBounds</h1>  <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><msub><mi>L</mi><mi>D</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>D</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate}) = [L_D, U_D]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>
<p>Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>=</mo><mfrac><mn>2</mn><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mo>+</mo><mi>m</mi></mrow><mi>n</mi></mfrac><mo fence="true">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">min_S = \frac{2}{\binom{n + m}{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.8551em;vertical-align:-1.01em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.3925em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top:0.075em"><span class="delimsizing size1 mtight"><span class="mtight">(</span></span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8877em"><span style="top:-2.156em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-2.971em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em"><span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top:0.075em"><span class="delimsizing size1 mtight"><span class="mtight">)</span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.01em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">⌊</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo stretchy="false">⌋</mo></mrow></msup><mo separator="true">,</mo><msup><mn>2</mn><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">⌊</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌋</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">min_A = 2 \cdot \max(2^{1-\lfloor \frac{n}{2} \rfloor}, 2^{1-\lfloor \frac{m}{2} \rfloor})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.363em;margin-right:0.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mopen mtight">⌊</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:0.049em"></span></span><span style="top:-3.384em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">⌋</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.363em;margin-right:0.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mopen mtight">⌊</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6915em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2255em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:0.049em"></span></span><span style="top:-3.384em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mclose mtight">⌋</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. Require <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>≥</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>+</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">\mathrm{misrate} \geq min_S + min_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8038em;vertical-align:-0.136em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>extra</mtext><mo>=</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>−</mo><mo stretchy="false">(</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>+</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{extra} = \mathrm{misrate} - (min_S + min_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord text"><span class="mord">extra</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7512em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>S</mi></msub><mo>=</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>+</mo><mfrac><mtext>extra</mtext><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\alpha_S = min_S + \frac{\text{extra}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1696em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8246em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">extra</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>A</mi></msub><mo>=</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub><mo>+</mo><mfrac><mtext>extra</mtext><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\alpha_A = min_A + \frac{\text{extra}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1696em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8246em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">extra</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. Compute <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>S</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>S</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">ShiftBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><msub><mi>α</mi><mi>S</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[L_S, U_S] = \operatorname{ShiftBounds}(\mathbf{x}, \mathbf{y}, \alpha_S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">ShiftBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>A</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">AvgSpreadBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><msub><mi>α</mi><mi>A</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[L_A, U_A] = \operatorname{AvgSpreadBounds}(\mathbf{x}, \mathbf{y}, \alpha_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">AvgSpreadBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>A</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_A &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, return <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>D</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>D</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L_D, U_D] = [\min(\frac{L_S}{L_A}, \frac{L_S}{U_A}, \frac{U_S}{L_A}, \frac{U_S}{U_A}), \max(\frac{L_S}{L_A}, \frac{L_S}{U_A}, \frac{U_S}{L_A}, \frac{U_S}{U_A})]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3339em;vertical-align:-0.4453em"></span><span class="mopen">[</span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)]</span></span></span></span>.</p>
<p>If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>A</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_A = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, return the tightest single interval that is always valid:</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[\frac{L_S}{U_A}, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3339em;vertical-align:-0.4453em"></span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>S</mi></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_S &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(-\infty, \frac{U_S}{U_A}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3339em;vertical-align:-0.4453em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>S</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_S = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>S</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_S &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>S</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_S = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(-\infty, 0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></li>
<li>otherwise: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-\infty, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>A</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_A = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, use the sign-only rule: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[0, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S \geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(-\infty, 0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>S</mi></msub><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_S \leq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-\infty, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span> otherwise (with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span> when <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>=</mo><msub><mi>U</mi><mi>S</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S = U_S = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>).</p>
<p>Robust bounds on <a href="/disparity"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Disparity</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{Disparity}(\mathbf{x}, \mathbf{y})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">Disparity</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mclose">)</span></span></span></span></a> with specified coverage.</p>
<ul>
<li><strong>Interpretation</strong>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><annotation encoding="application/x-tex">\mathrm{misrate}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span></span></span></span> is probability that true disparity falls outside bounds</li>
<li><strong>Domain</strong>  any real numbers, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n \geq 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m \geq 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>≥</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>+</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">\mathrm{misrate} \geq min_S + min_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8038em;vertical-align:-0.136em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></li>
<li><strong>Assumptions</strong>  <a href="/assumptions#sparity-assumption">sparity(x)</a>, <a href="/assumptions#sparity-assumption">sparity(y)</a></li>
<li><strong>Unit</strong>  dimensionless (spread units)</li>
<li><strong>Note</strong>  Bonferroni split between shift and avg-spread bounds; no independence assumption needed; bounds may be unbounded when pooled spread cannot be certified positive</li>
</ul>
<p><strong>Properties</strong></p>
<ul>
<li><strong>Location invariance</strong> <span style="display:inline-block;width:2em"></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}(\mathbf{x} + k, \mathbf{y} + k, \mathrm{misrate}) = \operatorname{DisparityBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span></span></span></span></li>
<li><strong>Scale invariance</strong> <span style="display:inline-block;width:2em"></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><mo>⋅</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi>k</mi><mo>⋅</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">sign</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}(k \cdot \mathbf{x}, k \cdot \mathbf{y}, \mathrm{misrate}) = \operatorname{sign}(k) \cdot \operatorname{DisparityBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">sign</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span></span></span></span></li>
<li><strong>Antisymmetry</strong> <span style="display:inline-block;width:2em"></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate}) = -\operatorname{DisparityBounds}(\mathbf{y}, \mathbf{x}, \mathrm{misrate})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span></span></span></span> (bounds reversed)</li>
<li><strong>Monotonicity in misrate</strong> <span style="display:inline-block;width:2em"></span> smaller <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><annotation encoding="application/x-tex">\mathrm{misrate}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span></span></span></span> produces wider bounds</li>
</ul>
<p><strong>Example</strong></p>
<ul>
<li><code>DisparityBounds([1..30], [21..50], 0.02)</code> returns bounds containing <code>Disparity</code></li>
</ul>
<h2 id="algorithm">Algorithm</h2>
<p>The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span></span></span></span> estimator constructs bounds on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Disparity</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{Disparity}(\mathbf{x}, \mathbf{y})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">Disparity</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mclose">)</span></span></span></span> by combining <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ShiftBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{ShiftBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mop"><span class="mord mathrm">ShiftBounds</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">AvgSpreadBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{AvgSpreadBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">AvgSpreadBounds</span></span></span></span></span> through a Bonferroni split.</p>
<p><strong>Misrate allocation</strong></p>
<p>The total <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><annotation encoding="application/x-tex">\mathrm{misrate}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span></span></span></span> budget is split between the shift and avg-spread components. Let <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>=</mo><mfrac><mn>2</mn><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mo>+</mo><mi>m</mi></mrow><mi>n</mi></mfrac><mo fence="true">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">min_S = \frac{2}{\binom{n + m}{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.8551em;vertical-align:-1.01em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.3925em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top:0.075em"><span class="delimsizing size1 mtight"><span class="mtight">(</span></span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8877em"><span style="top:-2.156em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-2.971em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em"><span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top:0.075em"><span class="delimsizing size1 mtight"><span class="mtight">)</span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.01em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> (minimum for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ShiftBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{ShiftBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mop"><span class="mord mathrm">ShiftBounds</span></span></span></span></span>) and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">⌊</mo><mi>n</mi><mi>s</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>h</mi><mn>2</mn><mo stretchy="false">⌋</mo></mrow></msup><mo separator="true">,</mo><msup><mn>2</mn><mrow><mn>1</mn><mo>−</mo><mo stretchy="false">⌊</mo><mi>m</mi><mi>s</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>h</mi><mn>2</mn><mo stretchy="false">⌋</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">min_A = 2 \cdot \max(2^{1-\lfloor n slash 2 \rfloor}, 2^{1-\lfloor m slash 2 \rfloor})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mopen mtight">⌊</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">h</span><span class="mord mtight">2</span><span class="mclose mtight">⌋</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mopen mtight">⌊</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">h</span><span class="mord mtight">2</span><span class="mclose mtight">⌋</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> (minimum for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">AvgSpreadBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{AvgSpreadBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">AvgSpreadBounds</span></span></span></span></span>). The extra budget beyond the minimums is split equally:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>α</mi><mi>S</mi></msub><mo>=</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>+</mo><mfrac><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>−</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>−</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub></mrow><mn>2</mn></mfrac><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>α</mi><mi>A</mi></msub><mo>=</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub><mo>+</mo><mfrac><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>−</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>S</mi></msub><mo>−</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>A</mi></msub></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\alpha_S = min_S + \frac{\mathrm{misrate} - min_S - min_A}{2}, \quad
  \alpha_A = min_A + \frac{\mathrm{misrate} - min_S - min_A}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0309em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3449em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.0309em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3449em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p><strong>Component bounds</strong></p>
<p>Compute <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>S</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>S</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">ShiftBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><msub><mi>α</mi><mi>S</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[L_S, U_S] = \operatorname{ShiftBounds}(\mathbf{x}, \mathbf{y}, \alpha_S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">ShiftBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>A</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mi mathvariant="normal">AvgSpreadBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><msub><mi>α</mi><mi>A</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[L_A, U_A] = \operatorname{AvgSpreadBounds}(\mathbf{x}, \mathbf{y}, \alpha_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">AvgSpreadBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. By Bonferronis inequality, the probability that both intervals simultaneously contain their respective true values is at least <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>S</mi></msub><mo>−</mo><msub><mi>α</mi><mi>A</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow></mrow><annotation encoding="application/x-tex">1 - \alpha_S - \alpha_A = 1 - \mathrm{misrate}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span></span></span></span>.</p>
<p><strong>Interval division</strong></p>
<p>When <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>A</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_A &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>, the disparity bounds are obtained by dividing the shift interval by the avg-spread interval. Since dividing by a positive interval can flip the ordering depending on the sign of the numerator endpoints, the algorithm computes all four combinations and takes the extremes:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>D</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>D</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>L</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L_D, U_D] = [\min(\frac{L_S}{L_A}, \frac{L_S}{U_A}, \frac{U_S}{L_A}, \frac{U_S}{U_A}), \max(\frac{L_S}{L_A}, \frac{L_S}{U_A}, \frac{U_S}{L_A}, \frac{U_S}{U_A})]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em"></span><span class="mopen">[</span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)]</span></span></span></span></span>
<p><strong>Edge cases</strong></p>
<p>When <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>A</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_A = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> (the avg-spread interval includes zero), the bounds become partially or fully unbounded depending on the sign of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>L</mi><mi>S</mi></msub><mo separator="true">,</mo><msub><mi>U</mi><mi>S</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[L_S, U_S]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>:</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mfrac><msub><mi>L</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[\frac{L_S}{U_A}, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3339em;vertical-align:-0.4453em"></span><span class="mopen">[</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>S</mi></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_S &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mfrac><msub><mi>U</mi><mi>S</mi></msub><msub><mi>U</mi><mi>A</mi></msub></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(-\infty, \frac{U_S}{U_A}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3339em;vertical-align:-0.4453em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8886em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.4103em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4453em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>S</mi></msub><mo>=</mo><msub><mi>U</mi><mi>S</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">L_S = U_S = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></li>
<li>otherwise: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-\infty, +\infty)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">+</span><span class="mord">∞</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p>When <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>A</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">U_A = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> (the avg-spread interval collapses to zero), only the sign of the shift determines the result.</p>
<pre class="astro-code astro-code-themes kanagawa-lotus nord" style="background-color:#F2ECBC;--shiki-dark-bg:#2e3440ff;color:#545464;--shiki-dark:#d8dee9ff;overflow-x:auto" tabindex="0" data-language="cs"><code><span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">using</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Pragmastat</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Algorithms</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">using</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Pragmastat</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Exceptions</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">using</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Pragmastat</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Internal</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">using</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Pragmastat</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Metrology</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">using</span><span style="color:#624C83;--shiki-dark:#81A1C1"> static</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Pragmastat</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Functions</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">MinAchievableMisrate</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">namespace</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Pragmastat</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Estimators</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#716E61;--shiki-dark:#616E88">/// </span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">&lt;</span><span style="color:#77713F;--shiki-dark:#81A1C1">summary</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">&gt;</span></span>
<span class="line"><span style="color:#716E61;--shiki-dark:#616E88">/// Distribution-free bounds for disparity using Bonferroni combination.</span></span>
<span class="line"><span style="color:#716E61;--shiki-dark:#616E88">/// </span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">&lt;/</span><span style="color:#77713F;--shiki-dark:#81A1C1">summary</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">&gt;</span></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">public</span><span style="color:#624C83;--shiki-dark:#81A1C1"> class</span><span style="color:#597B75;--shiki-dark:#8FBCBB"> DisparityBoundsEstimator</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> :</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> ITwoSampleBoundsEstimator</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">{</span></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">  public</span><span style="color:#624C83;--shiki-dark:#81A1C1"> static</span><span style="color:#624C83;--shiki-dark:#81A1C1"> readonly</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> DisparityBoundsEstimator</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Instance</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">()</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">  public</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4D699B;--shiki-dark:#88C0D0"> Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Sample</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Sample</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Probability</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> misrate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">  {</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    return</span><span style="color:#4D699B;--shiki-dark:#88C0D0"> Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> misrate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#CC6D00;--shiki-dark:#81A1C1"> null</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">  public</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4D699B;--shiki-dark:#88C0D0"> Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF">Sample</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Sample</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Probability</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> misrate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#81A1C1"> string</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">?</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> seed</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">  {</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#D8DEE9">    Assertion</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">MatchedUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#716E61;--shiki-dark:#616E88">    // Check validity (priority 0)</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#D8DEE9">    Assertion</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Validity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">X</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#D8DEE9">    Assertion</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Validity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#81A1C1">double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">IsNaN</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">misrate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ||</span><span style="color:#545464;--shiki-dark:#D8DEE9"> misrate</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ||</span><span style="color:#545464;--shiki-dark:#D8DEE9"> misrate</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &gt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 1</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      throw</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AssumptionException</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Domain</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Misrate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    int</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> n</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Size</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    int</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> m</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Size</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">n</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      throw</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AssumptionException</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Domain</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">X</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">m</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      throw</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AssumptionException</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Domain</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> minShift</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#4D699B;--shiki-dark:#88C0D0"> TwoSample</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">n</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> m</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> minX</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#4D699B;--shiki-dark:#88C0D0"> OneSample</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">n</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> minY</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#4D699B;--shiki-dark:#88C0D0"> OneSample</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">m</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> minAvg</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2.0</span><span style="color:#77713F;--shiki-dark:#81A1C1"> *</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Max</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">minX</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> minY</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">misrate</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;</span><span style="color:#545464;--shiki-dark:#D8DEE9"> minShift</span><span style="color:#77713F;--shiki-dark:#81A1C1"> +</span><span style="color:#545464;--shiki-dark:#D8DEE9"> minAvg</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      throw</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AssumptionException</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Domain</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Misrate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> extra</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> misrate</span><span style="color:#77713F;--shiki-dark:#81A1C1"> -</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">minShift</span><span style="color:#77713F;--shiki-dark:#81A1C1"> +</span><span style="color:#545464;--shiki-dark:#D8DEE9"> minAvg</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> alphaShift</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> minShift</span><span style="color:#77713F;--shiki-dark:#81A1C1"> +</span><span style="color:#545464;--shiki-dark:#D8DEE9"> extra</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2.0</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> alphaAvg</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> minAvg</span><span style="color:#77713F;--shiki-dark:#81A1C1"> +</span><span style="color:#545464;--shiki-dark:#D8DEE9"> extra</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 2.0</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">FastSpread</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">SortedValues</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> isSorted</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">:</span><span style="color:#CC6D00;--shiki-dark:#81A1C1"> true</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;=</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      throw</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AssumptionException</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Sparity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">X</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">FastSpread</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">SortedValues</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> isSorted</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">:</span><span style="color:#CC6D00;--shiki-dark:#81A1C1"> true</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;=</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      throw</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AssumptionException</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Sparity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Subject</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">    var</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> shiftBounds</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ShiftBoundsEstimator</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> alphaShift</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-dark:#81A1C1">    var</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> avgBounds</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> seed</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#CC6D00;--shiki-dark:#81A1C1"> null</span></span>
<span class="line"><span style="color:#77713F;--shiki-dark:#81A1C1">      ?</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AvgSpreadBoundsEstimator</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> alphaAvg</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#77713F;--shiki-dark:#81A1C1">      :</span><span style="color:#545464;--shiki-dark:#D8DEE9"> AvgSpreadBoundsEstimator</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Estimate</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">x</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> y</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> alphaAvg</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> seed</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> la</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> avgBounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Lower</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> ua</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> avgBounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Upper</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> shiftBounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Lower</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">    double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> shiftBounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Upper</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">la</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &gt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">    {</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">      double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> r1</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#545464;--shiki-dark:#D8DEE9"> la</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">      double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> r2</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ua</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">      double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> r3</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#545464;--shiki-dark:#D8DEE9"> la</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">      double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> r4</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ua</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">      double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> lower</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Min</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Min</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">r1</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> r2</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">),</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Min</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">r3</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> r4</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">))</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#545464;--shiki-dark:#81A1C1">      double</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> upper</span><span style="color:#77713F;--shiki-dark:#81A1C1"> =</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Max</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Max</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">r1</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> r2</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">),</span><span style="color:#545464;--shiki-dark:#D8DEE9"> Math</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#4D699B;--shiki-dark:#88C0D0">Max</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">r3</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> r4</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">))</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">lower</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> upper</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ua</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;=</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">    {</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &amp;&amp;</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">        return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#B35B79;--shiki-dark:#B48EAD">0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &gt;=</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">        return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#B35B79;--shiki-dark:#B48EAD">0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#81A1C1"> double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">PositiveInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;=</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">        return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#81A1C1">double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">NegativeInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#81A1C1">double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">NegativeInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#81A1C1"> double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">PositiveInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &gt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ua</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#81A1C1"> double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">PositiveInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#81A1C1">double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">NegativeInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> /</span><span style="color:#545464;--shiki-dark:#D8DEE9"> ua</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &amp;&amp;</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#B35B79;--shiki-dark:#B48EAD">0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &amp;&amp;</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &gt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#B35B79;--shiki-dark:#B48EAD">0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#81A1C1"> double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">PositiveInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    if</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4"> (</span><span style="color:#545464;--shiki-dark:#D8DEE9">ls</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &lt;</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#77713F;--shiki-dark:#81A1C1"> &amp;&amp;</span><span style="color:#545464;--shiki-dark:#D8DEE9"> us</span><span style="color:#77713F;--shiki-dark:#81A1C1"> ==</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">      return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#81A1C1">double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">NegativeInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#B35B79;--shiki-dark:#B48EAD"> 0.0</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#624C83;--shiki-light-font-weight:bold;--shiki-dark:#81A1C1;--shiki-dark-font-weight:inherit">    return</span><span style="color:#77713F;--shiki-dark:#81A1C1"> new</span><span style="color:#597B75;--shiki-dark:#D8DEE9FF"> Bounds</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">(</span><span style="color:#545464;--shiki-dark:#81A1C1">double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">NegativeInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#81A1C1"> double</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">PositiveInfinity</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">,</span><span style="color:#545464;--shiki-dark:#D8DEE9"> DisparityUnit</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">.</span><span style="color:#545464;--shiki-dark:#D8DEE9">Instance</span><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">)</span><span style="color:#4E8CA2;--shiki-dark:#81A1C1">;</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">  }</span></span>
<span class="line"><span style="color:#4E8CA2;--shiki-dark:#ECEFF4">}</span></span></code></pre>
<h2 id="tests">Tests</h2>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">ShiftBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">AvgSpreadBounds</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate}) = \operatorname{ShiftBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate}) / \operatorname{AvgSpreadBounds}(\mathbf{x}, \mathbf{y}, \mathrm{misrate})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm">ShiftBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span><span class="mord">/</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mord mathrm">AvgSpreadBounds</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mclose">)</span></span></span></span></span>
<p>The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span></span></span></span> test suite contains 39 test cases (3 demo + 5 natural + 6 property + 5 edge + 5 misrate + 2 distro + 6 unsorted + 7 error). Since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span></span></span></span> returns bounds rather than a point estimate, tests validate that the bounds contain <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Disparity</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{Disparity}(\mathbf{x}, \mathbf{y})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop"><span class="mord mathrm" style="margin-right:0.01389em">Disparity</span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mclose">)</span></span></span></span> and satisfy equivariance properties. Each test case output is a JSON object with <code>lower</code> and <code>upper</code> fields representing the interval bounds. Because the denominator (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">AvgSpreadBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{AvgSpreadBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">AvgSpreadBounds</span></span></span></span></span>) uses randomized <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">SpreadBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{SpreadBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">SpreadBounds</span></span></span></span></span>, tests fix a <code>seed</code> to keep outputs deterministic.</p>
<p><strong>Demo examples</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">n = m = 30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">30</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n = m = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">20</span></span></span></span>)  from manual introduction:</p>
<ul>
<li><code>demo-1</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>30</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 30)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">30</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>21</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (21, \ldots, 50)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">21</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">50</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.02</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.02</span></span></span></span></li>
<li><code>demo-2</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>30</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 30)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">30</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>21</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (21, \ldots, 50)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">21</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">50</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.005</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.005</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.005</span></span></span></span>, wider bounds (tighter misrate)</li>
<li><code>demo-3</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>20</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 20)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">20</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>5</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>24</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (5, \ldots, 24)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">24</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.05</span></span></span></span></li>
</ul>
<p>These cases illustrate how tighter misrates produce wider bounds.</p>
<p><strong>Natural sequences</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.2</span></span></span></span>)  5 tests:</p>
<ul>
<li><code>natural-10-10</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (1, \ldots, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span>, bounds containing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></li>
<li><code>natural-10-15</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (1, \ldots, 15)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">15</span><span class="mclose">)</span></span></span></span></li>
<li><code>natural-15-10</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 15)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">15</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (1, \ldots, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span></li>
<li><code>natural-15-15</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 15)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">15</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (1, \ldots, 15)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">15</span><span class="mclose">)</span></span></span></span>, bounds containing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></li>
<li><code>natural-20-20</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>20</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 20)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">20</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>20</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (1, \ldots, 20)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">20</span><span class="mclose">)</span></span></span></span>, bounds containing <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></li>
</ul>
<p><strong>Property validation</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n = m = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.2</span></span></span></span>)  6 tests:</p>
<ul>
<li><code>property-identity</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>18</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (0, 2, \ldots, 18)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">18</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>18</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (0, 2, \ldots, 18)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">18</span><span class="mclose">)</span></span></span></span>, bounds must contain <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></li>
<li><code>property-location-shift</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span> shifted by constant, same bounds as identity (location invariance)</li>
<li><code>property-scale-2x</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span> scaled by 2, same bounds as identity (scale invariance)</li>
<li><code>property-scale-neg</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span> negated, bounds preserved (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>abs</mtext></mrow><annotation encoding="application/x-tex">\text{abs}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">abs</span></span></span></span></span> scaling)</li>
<li><code>property-symmetry</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>6</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (6, \ldots, 15)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">15</span><span class="mclose">)</span></span></span></span>, observed bounds</li>
<li><code>property-symmetry-swapped</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span> swapped, bounds negated (anti-symmetry)</li>
</ul>
<p><strong>Edge cases</strong>  boundary conditions (5 tests):</p>
<ul>
<li><code>edge-small</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">n = m = 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">6</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.6</span></span></span></span> (small samples)</li>
<li><code>edge-negative</code>: negative values for both samples</li>
<li><code>edge-mixed-signs</code>: mixed positive/negative values</li>
<li><code>edge-wide-range</code>: extreme value range</li>
<li><code>edge-asymmetric-10-20</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">m = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">20</span></span></span></span> (unbalanced sizes)</li>
</ul>
<p><strong>Misrate variation</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>20</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = (1, \ldots, 20)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">20</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>5</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>24</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = (5, \ldots, 24)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">24</span><span class="mclose">)</span></span></span></span>)  5 tests:</p>
<ul>
<li><code>misrate-2e-1</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.2</span></span></span></span></li>
<li><code>misrate-1e-1</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.1</span></span></span></span></li>
<li><code>misrate-5e-2</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.05</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.05</span></span></span></span></li>
<li><code>misrate-2e-2</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.02</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.02</span></span></span></span></li>
<li><code>misrate-1e-2</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\mathrm{misrate} = 0.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.01</span></span></span></span></li>
</ul>
<p>These tests validate monotonicity: smaller misrates produce wider bounds.</p>
<p><strong>Distribution tests</strong> (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi></mrow><annotation encoding="application/x-tex">\mathrm{misrate}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord"><span class="mord mathrm">misrate</span></span></span></span></span> varies)  2 tests:</p>
<ul>
<li><code>additive-20-20</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n = m = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">20</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder accentunder="true"><mi mathvariant="normal">Additive</mi><mo>⁡</mo><mo stretchy="true">‾</mo></munder><mo stretchy="false">(</mo><mn>10</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\underline{\operatorname{Additive}}(10, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-2.84em"><span class="pstrut" style="height:3em"></span><span class="underline-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mord mathrm">Additive</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li><code>uniform-20-20</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>m</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">n = m = 20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">20</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder accentunder="true"><mi mathvariant="normal">Uniform</mi><mo>⁡</mo><mo stretchy="true">‾</mo></munder><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\underline{\operatorname{Uniform}}(0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-2.84em"><span class="pstrut" style="height:3em"></span><span class="underline-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mord mathrm">Uniform</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
</ul>
<p><strong>Unsorted tests</strong>  verify independent sorting of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span> (6 tests):</p>
<ul>
<li><code>unsorted-reverse-x</code>: X reversed, Y sorted</li>
<li><code>unsorted-reverse-y</code>: X sorted, Y reversed</li>
<li><code>unsorted-reverse-both</code>: both reversed</li>
<li><code>unsorted-shuffle-x</code>: X shuffled, Y sorted</li>
<li><code>unsorted-shuffle-y</code>: X sorted, Y shuffled</li>
<li><code>unsorted-wide-range</code>: wide value range, both unsorted</li>
</ul>
<p>These tests validate that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">DisparityBounds</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">\operatorname{DisparityBounds}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">DisparityBounds</span></span></span></span></span> produces identical results regardless of input order.</p>
<p><strong>Error cases</strong>  inputs that violate assumptions (7 tests):</p>
<ul>
<li><code>error-empty-x</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{x} = ()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mclose">)</span></span></span></span> (empty X array)</li>
<li><code>error-empty-y</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y} = ()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mclose">)</span></span></span></span> (empty Y array)</li>
<li><code>error-single-element-x</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="bold">x</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\mathbf{x}| = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathbf">x</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> (too few elements for pairing)</li>
<li><code>error-single-element-y</code>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="bold">y</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\mathbf{y}| = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">∣</span><span class="mord mathbf" style="margin-right:0.01597em">y</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> (too few elements for pairing)</li>
<li><code>error-constant-x</code>: constant <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">x</span></span></span></span> violates sparity (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Spread</mi><mo>⁡</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\operatorname{Spread} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">Spread</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>)</li>
<li><code>error-constant-y</code>: constant <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span> violates sparity (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Spread</mi><mo>⁡</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\operatorname{Spread} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mop"><span class="mord mathrm">Spread</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>)</li>
<li><code>error-misrate-below-min</code>: misrate below minimum achievable</li>
</ul>  <nav class="prev-next-nav" aria-label="Page navigation" data-astro-cid-fxft7bm5><div class="prev-next-container" data-astro-cid-fxft7bm5><a href="/disparity" class="prev-next-link prev" data-astro-cid-fxft7bm5><span class="prev-next-direction" data-astro-cid-fxft7bm5>Previous</span><span class="prev-next-title" data-astro-cid-fxft7bm5>Disparity</span></a><a href="/rng" class="prev-next-link next" data-astro-cid-fxft7bm5><span class="prev-next-direction" data-astro-cid-fxft7bm5>Next</span><span class="prev-next-title" data-astro-cid-fxft7bm5>Rng</span></a></div></nav> </article> </main> <!-- Expand button (visible when sidebar is collapsed) --> <button id="sidebar-expand" class="sidebar-expand" aria-label="Expand sidebar" data-astro-cid-mw7aashj> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-mw7aashj> <polyline points="13 17 18 12 13 7" data-astro-cid-mw7aashj></polyline> <polyline points="6 17 11 12 6 7" data-astro-cid-mw7aashj></polyline> </svg> </button> </div>  <header class="mobile-header" data-astro-cid-mw7aashj> <button id="menu-button" class="menu-button" aria-label="Toggle navigation menu" aria-expanded="false" data-astro-cid-4yyail6s> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-astro-cid-4yyail6s> <line x1="3" y1="6" x2="21" y2="6" data-astro-cid-4yyail6s></line> <line x1="3" y1="12" x2="21" y2="12" data-astro-cid-4yyail6s></line> <line x1="3" y1="18" x2="21" y2="18" data-astro-cid-4yyail6s></line> </svg> </button>  <a href="/" class="mobile-logo" data-astro-cid-mw7aashj>Pragmastat</a> <div class="mobile-header-right" data-astro-cid-mw7aashj> <a href="https://github.com/AndreyAkinshin/pragmastat" class="github-button" target="_blank" rel="noopener noreferrer" aria-label="GitHub repository" data-astro-cid-xtw5atjx> <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-astro-cid-xtw5atjx> <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" data-astro-cid-xtw5atjx></path> </svg> </a>  <div class="theme-switcher" data-astro-cid-dz5h74bc> <button class="theme-button" id="theme-button" aria-label="Toggle theme" aria-haspopup="true" data-astro-cid-dz5h74bc> <svg class="icon icon-system" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="10" data-astro-cid-dz5h74bc></circle> <path d="M12 2a10 10 0 0 1 0 20" fill="currentColor" stroke="none" data-astro-cid-dz5h74bc></path> </svg> <svg class="icon icon-light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="5" data-astro-cid-dz5h74bc></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-dz5h74bc></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-dz5h74bc></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-dz5h74bc></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-dz5h74bc></line> </svg> <svg class="icon icon-dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-dz5h74bc></path> </svg> </button> <div class="theme-dropdown" id="theme-dropdown" data-astro-cid-dz5h74bc> <button class="theme-option" data-theme="system" data-astro-cid-dz5h74bc> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="10" data-astro-cid-dz5h74bc></circle> <path d="M12 2a10 10 0 0 1 0 20" fill="currentColor" stroke="none" data-astro-cid-dz5h74bc></path> </svg>
System
</button> <button class="theme-option" data-theme="light" data-astro-cid-dz5h74bc> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <circle cx="12" cy="12" r="5" data-astro-cid-dz5h74bc></circle> <line x1="12" y1="1" x2="12" y2="3" data-astro-cid-dz5h74bc></line> <line x1="12" y1="21" x2="12" y2="23" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-astro-cid-dz5h74bc></line> <line x1="1" y1="12" x2="3" y2="12" data-astro-cid-dz5h74bc></line> <line x1="21" y1="12" x2="23" y2="12" data-astro-cid-dz5h74bc></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-astro-cid-dz5h74bc></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-astro-cid-dz5h74bc></line> </svg>
Light
</button> <button class="theme-option" data-theme="dark" data-astro-cid-dz5h74bc> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-astro-cid-dz5h74bc> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" data-astro-cid-dz5h74bc></path> </svg>
Dark
</button> </div> </div>   </div> </header>  <div class="sidebar-overlay" id="sidebar-overlay" data-astro-cid-mw7aashj></div> <script type="module" src="/_astro/DocsLayout.astro_astro_type_script_index_0_lang.Drf88MQ-.js"></script>  </body></html> 